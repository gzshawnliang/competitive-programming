{
  "reportPageName": "报表",
  "reportCatalogs": [
    {
      "catalogName": "客服管理",
      "reports": [
        {
          "ShowProject": true,
          "Subtitle": "单位：%",
          "ColumnsWidth": "来源区域=96px;诉求单数=64px",
          "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
          "reportId": 110,
          "graphColors": "#0099e5,#ff4c4c,#34bf49,#FFCC00",
          "graph": "pie",
          "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
          "reportName": "服务及时率统计分析"
        },
        {
          "ShowProject": true,
          "Subtitle": "单位：%",
          "ColumnsWidth": "来源区域=96px;诉求单数=64px",
          "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
          "reportId": 120,
          "graphColors": "#0099e5,#ff4c4c,#34bf49,#FFCC00",
          "graph": "column",
          "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
          "reportName": "服务跟进情况统计分析(column)"
        },
        {
          "ShowProject": true,
          "Subtitle": "单位：%",
          "ColumnsWidth": "来源区域=96px;诉求单数=64px",
          "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
          "reportId": 130,
          "graph": "line+column",
          "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
          "reportName": "服务完成情况统计分析(line+column)"
        },
        {
          "ShowProject": true,
          "Subtitle": "单位：%",
          "ColumnsWidth": "来源区域=96px;诉求单数=64px",
          "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
          "reportId": 140,
          "graph": "line",
          "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
          "reportName": "服务完成情况统计分析(line)"
        },
        {
          "ShowProject": true,
          "Subtitle": "单位：%",
          "reportId": 150,
          "reportName": "组合报表(多表)",
          "filter": [
            {
              "name": "诉求类型",
              "valueList": [],
              "sql": "SELECT '投诉'\nUNION\nSELECT '普通诉求'"
            },
            {
              "name": "区域",
              "valueList": [
                "公共区域",
                "户内诉求"
              ],
              "sql": ""
            }
          ],
          "reports": [
            {
              "ColumnsWidth": "来源区域=96px;诉求单数=64px",
              "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
              "graphColors": "#0099e5,#ff4c4c,#34bf49,#FFCC00",
              "graph": "column",
              "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
              "reportName": "服务跟进情况统计分析(column)"
            },
            {
              "graph": "line+column",
              "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
              "reportName": ""
            },
            {
              "graph": "line",
              "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  ",
              "reportName": "服务完成情况统计分析(line)"
            },
            {
              "ColumnsWidth": "来源区域=96px;诉求单数=64px",
              "ColumnsFormat": "来源区域=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
              "reportSql": "--统计完成率，及时率，满意率\nDECLARE @srBeginDate datetime, @srEndDate datetime\nSET @srBeginDate=CAST('<Date1>' AS datetime)\nSET @srEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nDECLARE @orgRootType int, @orgGroupType int, @orgItemType int, @orgLevel int\nSELECT @orgRootType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='集团公司'\nSELECT @orgGroupType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='分支机构'\nSELECT @orgItemType=B.[VALUE_ID] FROM [dbo].[VALUELIST] A, [dbo].[VALUELIST_DETAIL] B\n  WHERE A.[VALUELIST_ID]=B.[VALUELIST_ID] AND A.[VALUELIST_NAME]='ManagementOrganisationType' AND B.[VALUE_TEXT]='责任单元'\nSELECT @orgLevel=COUNT([ORGANISATION_ID]) FROM [dbo].[MANAGEMENT_ORGANISATION] WHERE [ORGANISATION_TYPE]=@orgRootType\n  AND [ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], TA.[SERVICE_REQUEST_COUNT] AS [诉求单数],\n  (CASE WHEN [COMPLETED_COUNT]>0 AND [SERVICE_REQUEST_COUNT]>0 THEN CAST([COMPLETED_COUNT]*100.00/[SERVICE_REQUEST_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [完成率],\n  (CASE WHEN [INTIME_COUNT]>0 AND [COMPLETED_COUNT]>0 THEN CAST([INTIME_COUNT]*100.00/[COMPLETED_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [及时率],\n  (CASE WHEN [SATISFY_COUNT]>0 AND [REVIEW_COUNT]>0 THEN CAST([SATISFY_COUNT]*100.00/[REVIEW_COUNT] AS decimal(10,2))\n    ELSE CAST(0 AS decimal(10,2)) END) AS [满意率]\n  FROM (SELECT T.[ORGANISATION_ID], COUNT(T.[SERVICE_REQUEST_ID]) AS [SERVICE_REQUEST_COUNT],\n  SUM(CASE WHEN T.[IS_COMPLETED]=1 THEN 1 ELSE 0 END) AS [COMPLETED_COUNT],\n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 THEN 1 ELSE 0 END) AS [INTIME_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 THEN 1 ELSE 0 END) AS [REVIEW_COUNT], \n  SUM(CASE WHEN T.[COMPLETION_INTIME]=1 AND T.[REVIEW_TAG]=1 AND T.[REVIEW_SATISFY]=1 THEN 1 ELSE 0 END) AS [SATISFY_COUNT]\n  FROM (SELECT (CASE WHEN @orgLevel>0 AND E.[ORGANISATION_TYPE]=@orgItemType THEN E.[PARENT_ORGANIZE_ID]\n    ELSE A.[ORGANISATION_ID] END) AS [ORGANISATION_ID],\n    A.[SERVICE_REQUEST_ID], A.[REQUEST_TYPE], A.[IS_INTERNAL], A.[SERVICE_REQUEST_NO], \n    A.[REQUEST_CONTENT], A.[CREATE_DATETIME], B.[SERVICE_ACTIVITY_ID],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) THEN A.[IS_COMPLETED] \n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN 1 ELSE 0 END) AS [IS_COMPLETED], \n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    THEN ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME])\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) THEN ISNULL(B.[ACTUAL_COMPLETION_DATETIME],ISNULL(B.[CLOSE_DATETIME],B.[MODIFY_DATETIME])) \n    ELSE NULL END) AS [COMPLETION_DATETIME],\n    (CASE WHEN (B.[SERVICE_ACTIVITY_ID] IS NULL OR B.[IS_DELETED]=1) AND A.[IS_COMPLETED]=1 \n    AND ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) IS NOT NULL \n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(A.[COMPLETION_DATE_TIME],A.[MODIFY_DATETIME]) THEN 1\n    WHEN B.[SERVICE_ACTIVITY_ID] IS NOT NULL AND B.[IS_DELETED]=0 AND (B.[IS_CLOSED]=1 OR B.[SERVICE_ACTIVITY_STATE]>=28030 \n    OR B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL) AND ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) IS NOT NULL\n    AND DATEADD(hh,24,A.[CREATE_DATETIME])>=ISNULL(B.[ACTUAL_COMPLETION_DATETIME],B.[CLOSE_DATETIME]) THEN 1 ELSE 0 END) AS [COMPLETION_INTIME],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL THEN 1 ELSE 0 END) AS [REVIEW_TAG],\n    (CASE WHEN D.[SERVICE_REVIEW_RESULT] IS NOT NULL AND D.[SERVICE_REVIEW_RESULT]<>32040 THEN 1 ELSE 0 END) AS [REVIEW_SATISFY]\n    FROM [dbo].[CS_SERVICE_REQUEST] A\n    LEFT JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID]\n    LEFT JOIN (SELECT ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID]) AS [SERVICE_REQUEST_ID], \n      MAX([SERVICE_REVIEW_ID]) AS [SERVICE_REVIEW_ID] FROM [dbo].[CS_SERVICE_REVIEW] \n      GROUP BY ISNULL([SERVICE_REQUEST_ID],[SERVICE_ACTIVITY_ID])\n    ) C ON A.[SERVICE_REQUEST_ID]=C.[SERVICE_REQUEST_ID]\n    LEFT JOIN [dbo].[CS_SERVICE_REVIEW] D ON C.[SERVICE_REVIEW_ID]=D.[SERVICE_REVIEW_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] E ON A.[ORGANISATION_ID]=E.[ORGANISATION_ID]\n    LEFT JOIN [dbo].[MANAGEMENT_ORGANISATION] F ON E.[PARENT_ORGANIZE_ID]=F.[ORGANISATION_ID]\n    WHERE A.[CREATE_DATETIME] between @srBeginDate and @srEndDate\n    AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n    AND A.[IS_ENABLED]=1 AND A.[IS_DELETED]=0\n  ) T GROUP BY T.[ORGANISATION_ID]) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[ORGANISATION_ID]=TB.[ORGANISATION_ID]\n  ORDER BY (CASE WHEN @orgLevel>0 AND TB.[ORGANISATION_TYPE]=@orgRootType THEN 0 \n    WHEN @orgLevel=0 AND TB.[ORGANISATION_TYPE]=@orgGroupType THEN 0 ELSE ISNULL(TB.[POSITION],0)+1 END)\n  "
            }
          ]
        },
        {
          "ShowProject": true,
          "reportId": 175,
          "reportName": "已完成任务",
          "filter": [
            {
              "name": "诉求类型",
              "valueList": [
                "业主诉求",
                "内部诉求"
              ],
              "sql": ""
            }
          ],
          "reports": [
            {
              "ColumnsWidth": "部门=96px;枫丹丽舍=64px;珠海名都=64px",
              "ColumnsFormat": "部门=n0;枫丹丽舍=n0;珠海名都=n0",
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isIntl int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSET @isIntl=2 \nSELECT @isIntl=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSELECT \n  (CASE WHEN A.[REQUEST_TYPE]=26010 THEN '客服' WHEN A.[REQUEST_TYPE]=26020 THEN '工程' \n  WHEN A.[REQUEST_TYPE]=26030 THEN '投诉' WHEN A.[REQUEST_TYPE]=26040 THEN '建议' \n  WHEN A.[REQUEST_TYPE]=26050 THEN '验房' ELSE '其它' END) AS [部门], \n  SUM(CASE WHEN A.[ORGANISATION_ID]=35100 THEN 1 ELSE 0 END) AS [枫丹丽舍], \n  SUM(CASE WHEN A.[ORGANISATION_ID]=587318 THEN 1 ELSE 0 END) AS [珠海名都] \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL\n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND (CASE WHEN @isIntl=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isIntl \n  GROUP BY A.[REQUEST_TYPE] \n",
              "reportName": ""
            },
            {
              "Subtitle": "单位：占比",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计占比\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isIntl int, @saCount int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSELECT @isIntl=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSELECT @saCount=COUNT(A.[SERVICE_REQUEST_ID])\n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL\n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=35100 \n  AND (CASE WHEN @isIntl=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isIntl \nSELECT \n  (CASE WHEN A.[REQUEST_TYPE]=26010 THEN '客服' WHEN A.[REQUEST_TYPE]=26020 THEN '工程' \n  WHEN A.[REQUEST_TYPE]=26030 THEN '投诉' WHEN A.[REQUEST_TYPE]=26040 THEN '建议' \n  WHEN A.[REQUEST_TYPE]=26050 THEN '验房' ELSE '其它' END) AS [部门], \n  CAST(ROUND(CAST(COUNT(A.[SERVICE_REQUEST_ID])*100 AS decimal(10,2))/@saCount,2) AS decimal(10,2)) AS [占比] \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL\n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=35100 \n  AND (CASE WHEN @isIntl=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isIntl \n  GROUP BY A.[REQUEST_TYPE] \n",
              "reportName": "枫丹丽舍--已完成任务"
            },
            {
              "Subtitle": "单位：占比",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计占比\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isIntl int, @saCount int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSELECT @isIntl=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSELECT @saCount=COUNT(A.[SERVICE_REQUEST_ID])\n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL\n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=587318 \n  AND (CASE WHEN @isIntl=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isIntl \nSELECT \n  (CASE WHEN A.[REQUEST_TYPE]=26010 THEN '客服' WHEN A.[REQUEST_TYPE]=26020 THEN '工程' \n  WHEN A.[REQUEST_TYPE]=26030 THEN '投诉' WHEN A.[REQUEST_TYPE]=26040 THEN '建议' \n  WHEN A.[REQUEST_TYPE]=26050 THEN '验房' ELSE '其它' END) AS [部门], \n  CAST(ROUND(CAST(COUNT(A.[SERVICE_REQUEST_ID])*100 AS decimal(10,2))/@saCount,2) AS decimal(10,2)) AS [占比] \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NOT NULL\n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=587318 \n  AND (CASE WHEN @isIntl=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isIntl \n  GROUP BY A.[REQUEST_TYPE] \n",
              "reportName": "珠海名都--已完成任务"
            }
          ]
        },
        {
          "ShowProject": true,
          "reportId": 177,
          "reportName": "未完成任务",
          "filter": [
            {
              "name": "诉求类型",
              "valueList": [
                "业主诉求",
                "内部诉求"
              ],
              "sql": ""
            },
            {
              "name": "部门",
              "valueList": [],
              "sql": "SELECT [VALUE_TEXT] FROM [dbo].[VALUELIST_DETAIL] WHERE [VALUELIST_ID]=82768 ORDER BY [VALUE_ID]"
            }
          ],
          "reports": [
            {
              "ColumnsWidth": "部门=96px;枫丹丽舍=64px;珠海名都=64px",
              "ColumnsFormat": "部门=n0;枫丹丽舍=n0;珠海名都=n0",
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isInternal int, @srType int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSET @isInternal=2 \nSELECT @isInternal=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSET @srType=0 \nSELECT TOP 1 @srType=ISNULL([VALUE_ID],0) FROM [dbo].[VALUELIST_DETAIL] \n  WHERE [VALUELIST_ID]=82768 AND [VALUE_TEXT]='<部门>' \nDECLARE @ncCountFd int, @allCountFd int, @ncCountZh int, @allCountZh int \nSELECT @ncCountFd=SUM(CASE WHEN A.[ORGANISATION_ID]=35100 AND B.[ACTUAL_COMPLETION_DATETIME] IS NULL THEN 1 ELSE 0 END), \n  @ncCountZh=SUM(CASE WHEN A.[ORGANISATION_ID]=587318 AND B.[ACTUAL_COMPLETION_DATETIME] IS NULL THEN 1 ELSE 0 END), \n  @allCountFd=SUM(CASE WHEN A.[ORGANISATION_ID]=35100 THEN 1 ELSE 0 END), \n  @allCountZh=SUM(CASE WHEN A.[ORGANISATION_ID]=587318 THEN 1 ELSE 0 END) \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN 0 ELSE A.[REQUEST_TYPE] END)=@srType \nSELECT \n  (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) AS [天数], \n  SUM(CASE WHEN A.[ORGANISATION_ID]=35100 THEN 1 ELSE 0 END) AS [枫丹丽舍], \n  SUM(CASE WHEN A.[ORGANISATION_ID]=587318 THEN 1 ELSE 0 END) AS [珠海名都] \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NULL \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN 0 ELSE A.[REQUEST_TYPE] END)=@srType \n  GROUP BY (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) \nUNION ALL \nSELECT '总计' AS [天数], @ncCountFd AS [枫丹丽舍], @ncCountZh AS [珠海名都] \nUNION ALL \nSELECT '未完成率(%)' AS [天数], \n  (CASE WHEN @allCountFd>0 THEN @ncCountFd*100/@allCountFd ELSE 0 END) AS [枫丹丽舍], \n  (CASE WHEN @allCountZh>0 THEN @ncCountZh*100/@allCountZh ELSE 0 END) AS [珠海名都] \n",
              "reportName": ""
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isInternal int, @srType int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSET @isInternal=2 \nSELECT @isInternal=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSET @srType=0 \nSELECT TOP 1 @srType=ISNULL([VALUE_ID],0) FROM [dbo].[VALUELIST_DETAIL] \n  WHERE [VALUELIST_ID]=82768 AND [VALUE_TEXT]='<部门>' \nDECLARE @ncCount int, @allCount int \nSELECT @ncCount=SUM(CASE WHEN B.[ACTUAL_COMPLETION_DATETIME] IS NULL THEN 1 ELSE 0 END), @allCount=COUNT(A.[SERVICE_REQUEST_ID]) \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=35100 \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN @srType ELSE A.[REQUEST_TYPE] END)=@srType \nSELECT \n  (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) AS [天数], \n  COUNT(A.[SERVICE_REQUEST_ID]) \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NULL \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=35100 \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN @srType ELSE A.[REQUEST_TYPE] END)=@srType \n  GROUP BY (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) \n",
              "reportName": "枫丹丽舍--未完成任务"
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @isInternal int, @srType int \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSET @uID=<UserId> \nSET @isInternal=2 \nSELECT @isInternal=(CASE WHEN '<诉求类型>'='业主诉求' THEN 0 WHEN '<诉求类型>'='内部诉求' THEN 1 ELSE 2 END) \nSET @srType=0 \nSELECT TOP 1 @srType=ISNULL([VALUE_ID],0) FROM [dbo].[VALUELIST_DETAIL] \n  WHERE [VALUELIST_ID]=82768 AND [VALUE_TEXT]='<部门>' \nDECLARE @ncCount int, @allCount int \nSELECT @ncCount=SUM(CASE WHEN B.[ACTUAL_COMPLETION_DATETIME] IS NULL THEN 1 ELSE 0 END), @allCount=COUNT(A.[SERVICE_REQUEST_ID]) \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=587318 \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN @srType ELSE A.[REQUEST_TYPE] END)=@srType \nSELECT \n  (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) AS [天数], \n  COUNT(A.[SERVICE_REQUEST_ID]) \n  FROM [dbo].[CS_SERVICE_REQUEST] A \n  INNER JOIN [dbo].[CS_SERVICE_ACTIVITY] B ON A.[SERVICE_REQUEST_ID]=B.[SERVICE_ACTIVITY_ID] \n  WHERE A.[IS_DELETED]=0 AND A.[IS_ENABLED]=1 AND B.[IS_DELETED]=0 \n  AND B.[ACTUAL_COMPLETION_DATETIME] IS NULL \n  AND A.[REQUEST_DATE_TIME] between @bDate and @eDate \n  AND A.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=@uID) \n  AND A.[ORGANISATION_ID]=587318 \n  AND (CASE WHEN @isInternal=2 THEN 2 ELSE CAST(A.[IS_INTERNAL] AS int) END)=@isInternal \n  AND (CASE WHEN @srType=0 THEN @srType ELSE A.[REQUEST_TYPE] END)=@srType \n  GROUP BY (CASE WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<3 THEN '3天以内' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<7 THEN '3-7天' \n  WHEN DATEDIFF(dd,A.[REQUEST_DATE_TIME],getdate())<30 THEN '7-30天' \n  ELSE '30天以上' END) \n",
              "reportName": "珠海名都--未完成任务"
            }
          ]
        },
        {
          "ShowProject": false,
          "reportId": 180,
          "reportName": "诉求类别完成率(多表)",
          "filter": [
            {
              "name": "诉求来源",
              "valueList": [
                "全部",
                "业主诉求",
                "内部诉求"
              ],
              "sql": ""
            }
          ],
          "reports": [
            {
              "ColumnsWidth": "诉求类别=96px;诉求单数=64px;完成率=64px;及时率=64px;满意率=64px",
              "ColumnsFormat": "诉求类别=n0;诉求单数=n0;完成率=n0;及时率=n0;满意率=n0",
              "Subtitle": "单位：单数;%;%;%",
              "ShowProject": true,
              "reportSql": "--统计单数,完成率,及时率,满意率\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityTypeRate] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=0 \n  ",
              "reportName": ""
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityTypeRate] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=1 \n  ",
              "reportName": "统计单数"
            },
            {
              "Subtitle": "单位：完成率",
              "ShowProject": true,
              "graph": "column",
              "reportSql": "--统计完成率\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityTypeRate] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=2 \n  ",
              "reportName": "统计完成率"
            },
            {
              "Subtitle": "单位：及时率",
              "ShowProject": true,
              "graph": "column",
              "reportSql": "--统计及时率\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityTypeRate] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=3 \n  ",
              "reportName": "统计及时率"
            },
            {
              "Subtitle": "单位：满意率",
              "ShowProject": true,
              "graph": "column",
              "reportSql": "--统计满意率\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityTypeRate] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=4 \n  ",
              "reportName": "统计满意率"
            }
          ]
        },
        {
          "ShowProject": true,
          "reportId": 181,
          "reportName": "任务已完成(多表)",
          "filter": [
            {
              "name": "诉求来源",
              "valueList": [
                "全部",
                "业主诉求",
                "内部诉求"
              ],
              "sql": ""
            }
          ],
          "reports": [
            {
              "ColumnsWidth": "部门=96px;逸彩=64px;枫丹丽舍=64px;广粤尊府=64px;金湖新世界=64px",
              "ColumnsFormat": "部门=n0;逸彩=n0;枫丹丽舍=n0;广粤尊府=n0;金湖新世界=n0",
              "Subtitle": "单位：单数;%;%;%",
              "ShowProject": true,
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityComp] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=0 \n  ",
              "reportName": ""
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityComp] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=1 \n  ",
              "reportName": "统计单数"
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityComp] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=2 \n  ",
              "reportName": "统计单数"
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityComp] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=3 \n  ",
              "reportName": "统计单数"
            },
            {
              "Subtitle": "单位：单数",
              "ShowProject": true,
              "graph": "pie",
              "reportSql": "--统计单数\nDECLARE @bDate datetime, @eDate datetime, @uID int, @rType nvarchar(50), @cUID nvarchar(50) \nSET @bDate=CAST('<Date1>' AS datetime) \nSET @eDate=CAST('<Date2>' AS datetime) \nSET @uID=<UserId> \nSET @rType='<诉求来源>' \nSET @cUID='<CompanyId>' \nEXEC [dbo].[IMGetServiceActivityComp] \n  @BeginDate=@bDate, @EndDate=@eDate, @CurrUserID=@uID, \n @AppUID=@cUID, @ResourceType=@rType, @SqlResult=4 \n  ",
              "reportName": "统计单数"
            }
          ]
        }
      ]
    },
    {
      "catalogName": "缴费管理",
      "reports": [
        {
          "reportId": 210,
          "Subtitle": "单位：单数,元",
          "ColumnsFormat": "来源区域=n0;收款收据=n0;收款金额=n0",
          "reportName": "来源区域缴费统计",
          "graph": "pie",
          "reportSql": "--统计收据单数，收款金额\nDECLARE @recBeginDate datetime, @recEndDate datetime\nSET @recBeginDate=CAST('<Date1>' AS datetime)\nSET @recEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], \n ISNULL(TA.[ReceiptNum],0) AS [收款收据], CAST(ISNULL(TA.[ReceiptAmount],0) AS decimal(10,2)) AS [收款金额]  \n FROM (SELECT E.[隶属] AS [OrgName], COUNT(A.[收据ID]) AS [ReceiptNum], \n      SUM(CASE WHEN A.[单据类别]='退款收据' THEN (0-A.[金额]) ELSE A.[金额] END) AS [ReceiptAmount]\n      FROM [wy].[dbo].[应预收款收据] A\n      INNER JOIN [wy].[dbo].[单元] B ON A.[单元ID]=B.[单元ID]\n      LEFT JOIN [wy].[dbo].[楼梯] C ON B.[楼梯ID]=C.[楼梯ID]\n      LEFT JOIN [wy].[dbo].[楼阁] D ON ISNULL(B.[楼阁ID],C.[楼阁ID])=D.[楼阁ID]\n      LEFT JOIN [wy].[dbo].[楼盘] E ON D.[楼盘ID]=E.[楼盘ID]\n   WHERE A.[收款日期] between @recBeginDate and @recEndDate\n   GROUP BY E.[隶属]\n  ) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[OrgName]=ISNULL(TB.[ORGANISATION_ABBR], TB.[ORGANISATION_NAME])\n WHERE TB.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n ORDER BY ISNULL(TB.[POSITION],0)"
        },
        {
          "reportId": 220,
          "Subtitle": "单位：单数,元",
          "ColumnsFormat": "来源区域=n0;收款收据=n0;收款金额=n0",
          "reportName": "缴费管理统计",
          "reportSql": ""
        },
        {
          "reportId": 211,
          "Subtitle": "单位：单数,元",
          "ColumnsFormat": "来源区域=n0;收款收据=n0;收款金额=n0",
          "reportName": "泰华花园缴费统计",
          "graph": "pie",
          "reportSql": "--统计收据单数，收款金额 \nDECLARE @recBeginDate datetime, @recEndDate datetime \nSET @recBeginDate=CAST('<Date1>' AS datetime) \nSET @recEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSELECT D.[楼阁名称] AS [楼阁], COUNT(A.[收据ID]) AS [收据单数],  \n  SUM(CASE WHEN A.[单据类别]='退款收据' THEN (0-A.[金额]) ELSE A.[金额] END) AS [收款金额] \n  FROM [wy].[dbo].[应预收款收据] A \n  INNER JOIN [wy].[dbo].[单元] B ON A.[单元ID]=B.[单元ID] \n  LEFT JOIN [wy].[dbo].[楼梯] C ON B.[楼梯ID]=C.[楼梯ID] \n  LEFT JOIN [wy].[dbo].[楼阁] D ON ISNULL(B.[楼阁ID],C.[楼阁ID])=D.[楼阁ID] \n  LEFT JOIN [wy].[dbo].[楼盘] E ON D.[楼盘ID]=E.[楼盘ID] \n  WHERE A.[收款日期] between @recBeginDate and @recEndDate \n  GROUP BY E.[隶属], D.[楼阁名称] \n"
        },
        {
          "reportId": 261,
          "Subtitle": "单位：单数,元",
          "ColumnsFormat": "来源区域=n0;收款收据=n0;收款金额=n0",
          "reportName": "锦绣城缴费统计",
          "reportSql": "--统计收据单数，收款金额 \nDECLARE @recBeginDate datetime, @recEndDate datetime \nSET @recBeginDate=CAST('<Date1>' AS datetime) \nSET @recEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime))) \nSELECT D.[楼阁名称] AS [楼阁], COUNT(A.[收据ID]) AS [ReceiptNum],  \n  SUM(CASE WHEN A.[单据类别]='退款收据' THEN (0-A.[金额]) ELSE A.[金额] END) AS [ReceiptAmount] \n  FROM [wy06].[dbo].[应预收款收据] A \n  INNER JOIN [wy06].[dbo].[单元] B ON A.[单元ID]=B.[单元ID] \n  LEFT JOIN [wy06].[dbo].[楼梯] C ON B.[楼梯ID]=C.[楼梯ID] \n  LEFT JOIN [wy06].[dbo].[楼阁] D ON ISNULL(B.[楼阁ID],C.[楼阁ID])=D.[楼阁ID] \n  LEFT JOIN [wy06].[dbo].[楼盘] E ON D.[楼盘ID]=E.[楼盘ID] \n  WHERE A.[收款日期] between @recBeginDate and @recEndDate \n  GROUP BY E.[隶属], D.[楼阁名称] \n"
        }
      ]
    },
    {
      "catalogName": "租赁管理",
      "reports": [
        {
          "reportId": 210,
          "Subtitle": "单位：单数,元",
          "ColumnsFormat": "来源区域=n0;收款收据=n0;收款金额=n0",
          "reportName": "来源区域缴费统计",
          "graph": "pie",
          "reportSql": "--统计收据单数，收款金额\nDECLARE @recBeginDate datetime, @recEndDate datetime\nSET @recBeginDate=CAST('<Date1>' AS datetime)\nSET @recEndDate=DATEADD(ss,-1,DATEADD(dd,1,CAST('<Date2>' AS datetime)))\nSELECT TB.[ORGANISATION_NAME] AS [来源区域], \n ISNULL(TA.[ReceiptNum],0) AS [收款收据], CAST(ISNULL(TA.[ReceiptAmount],0) AS decimal(10,2)) AS [收款金额]  \n FROM (SELECT E.[隶属] AS [OrgName], COUNT(A.[收据ID]) AS [ReceiptNum], \n      SUM(CASE WHEN A.[单据类别]='退款收据' THEN (0-A.[金额]) ELSE A.[金额] END) AS [ReceiptAmount]\n      FROM [wy].[dbo].[应预收款收据] A\n      INNER JOIN [wy].[dbo].[单元] B ON A.[单元ID]=B.[单元ID]\n      LEFT JOIN [wy].[dbo].[楼梯] C ON B.[楼梯ID]=C.[楼梯ID]\n      LEFT JOIN [wy].[dbo].[楼阁] D ON ISNULL(B.[楼阁ID],C.[楼阁ID])=D.[楼阁ID]\n      LEFT JOIN [wy].[dbo].[楼盘] E ON D.[楼盘ID]=E.[楼盘ID]\n   WHERE A.[收款日期] between @recBeginDate and @recEndDate\n   GROUP BY E.[隶属]\n  ) TA\n  INNER JOIN [dbo].[MANAGEMENT_ORGANISATION] TB ON TA.[OrgName]=ISNULL(TB.[ORGANISATION_ABBR], TB.[ORGANISATION_NAME])\n WHERE TB.[ORGANISATION_ID] IN (SELECT [ORGANIZE_ID] FROM [dbo].[ORGANIZE_USERS] WHERE [USER_ID]=<UserId>)\n ORDER BY ISNULL(TB.[POSITION],0)"
        }
      ]
    }
  ]
}